{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "resourceDefinitions": {
            "value": {
                "applicationConfigurationStores": [
                    {
                        "isPublicNetworkAccessEnabled": true,
                        "name": "byteterrace",
                        "settings": {
                            "array": [
                                {
                                    "contentType": "application/vnd.microsoft.appconfig.keyvaultref+json;charset=utf-8",
                                    "name": "Namecheap:ApiKey",
                                    "value": "{\"uri\":\"https://byteterrace.vault.azure.net/secrets/Namecheap-ApiKey\"}"
                                }
                            ]
                        }
                    }
                ],
                "applicationSecurityGroups": [
                    {
                        "name": "byteterrace"
                    }
                ],
                "availabilitySets": [
                    {
                        "name": "byteterrace",
                        "numberOfFaultDomains": 3,
                        "numberOfUpdateDomains": 5,
                        "proximityPlacementGroupName": "byteterrace"
                    }
                ],
                "bastionHosts": [
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "ipConfigurations": [
                            {
                                "name": "default",
                                "publicIpAddress": {
                                    "name": "AzureBastionPublicIpAddress"
                                },
                                "virtualNetwork": {
                                    "name": "byteterrace.net",
                                    "subnetName": "AzureBastionSubnet"
                                }
                            }
                        ],
                        "name": "byteterrace"
                    }
                ],
                "cdnProfiles": [
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "name": "byteterrace-net"
                    }
                ],
                "communicationServices": [
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "name": "byteterrace"
                    }
                ],
                "_containerInstances": [
                    {
                        "containers": [
                            {
                                "name": "byteterrace"
                            }
                        ],
                        "name": "byteterrace",
                        "operatingSystemName": "Linux",
                        "restartPolicy": "Always",
                        "skuName": "Standard",
                        "subnetName": "AzureContainerGroupsSubnet",
                        "virtualNetworkName": "byteterrace.net"
                    }
                ],
                "diskEncryptionSets": [
                    {
                        "keyName": "byteterrace-virtualmachine-diskencryption",
                        "keyVaultName": "byteterrace",
                        "keyVersion": "256e239939b74658a495edd9f5023420",
                        "name": "byteterrace"
                    }
                ],
                "dnsZones": {
                    "private": [
                        {
                            "name": "byteterrace.net",
                            "virtualNetworkLinks": [
                                {
                                    "isAutomaticVmRegistrationEnabled": true,
                                    "name": "byteterrace.net"
                                }
                            ]
                        },
                        {
                            "name": "privatelink.agentsvc.azure-automation.net",
                            "virtualNetworkLinks": [
                                {
                                    "name": "byteterrace.net"
                                }
                            ]
                        },
                        {
                            "name": "privatelink.azconfig.io",
                            "virtualNetworkLinks": [
                                {
                                    "name": "byteterrace.net"
                                }
                            ]
                        },
                        {
                            "name": "privatelink.blob.core.windows.net",
                            "virtualNetworkLinks": [
                                {
                                    "name": "byteterrace.net"
                                }
                            ]
                        },
                        {
                            "name": "privatelink.monitor.azure.com",
                            "virtualNetworkLinks": [
                                {
                                    "name": "byteterrace.net"
                                }
                            ]
                        },
                        {
                            "name": "privatelink.ods.opinsights.azure.com",
                            "virtualNetworkLinks": [
                                {
                                    "name": "byteterrace.net"
                                }
                            ]
                        },
                        {
                            "name": "privatelink.oms.opinsights.azure.com",
                            "virtualNetworkLinks": [
                                {
                                    "name": "byteterrace.net"
                                }
                            ]
                        }
                    ],
                    "public": [
                        {
                            "name": "byteterrace.app"
                        },
                        {
                            "cnameRecords": [
                                {
                                    "alias": "autodiscover.outlook.com",
                                    "name": "autodiscover",
                                    "timeToLiveInSeconds": 3600
                                },
                                {
                                    "alias": "enterpriseenrollment.manage.microsoft.com",
                                    "name": "enterpriseenrollment",
                                    "timeToLiveInSeconds": 3600
                                },
                                {
                                    "alias": "enterpriseregistration.windows.net",
                                    "name": "enterpriseregistration",
                                    "timeToLiveInSeconds": 3600
                                }
                            ],
                            "mxRecords": [
                                {
                                    "exchanges": [
                                        {
                                            "exchange": "byteterrace-com.mail.protection.outlook.com",
                                            "preference": 0
                                        }
                                    ],
                                    "name": "@",
                                    "timeToLiveInSeconds": 3600
                                }
                            ],
                            "name": "byteterrace.com",
                            "txtRecords": [
                                {
                                    "name": "@",
                                    "timeToLiveInSeconds": 3600,
                                    "values": [
                                        "v=spf1 include:spf.protection.outlook.com -all"
                                    ]
                                }
                            ]
                        },
                        {
                            "cnameRecords": [
                                {
                                    "alias": "autodiscover.outlook.com",
                                    "name": "autodiscover",
                                    "timeToLiveInSeconds": 3600
                                },
                                {
                                    "alias": "enterpriseenrollment.manage.microsoft.com",
                                    "name": "enterpriseenrollment",
                                    "timeToLiveInSeconds": 3600
                                },
                                {
                                    "alias": "enterpriseregistration.windows.net",
                                    "name": "enterpriseregistration",
                                    "timeToLiveInSeconds": 3600
                                }
                            ],
                            "mxRecords": [
                                {
                                    "exchanges": [
                                        {
                                            "exchange": "byteterrace-dev.mail.protection.outlook.com",
                                            "preference": 0
                                        }
                                    ],
                                    "name": "@",
                                    "timeToLiveInSeconds": 3600
                                }
                            ],
                            "name": "byteterrace.dev",
                            "txtRecords": [
                                {
                                    "name": "@",
                                    "timeToLiveInSeconds": 3600,
                                    "values": [
                                        "v=spf1 include:spf.protection.outlook.com -all"
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "byteterrace.info"
                        },
                        {
                            "cnameRecords": [
                                {
                                    "alias": "enterpriseenrollment.manage.microsoft.com",
                                    "name": "enterpriseenrollment",
                                    "timeToLiveInSeconds": 3600
                                },
                                {
                                    "alias": "enterpriseregistration.windows.net",
                                    "name": "enterpriseregistration",
                                    "timeToLiveInSeconds": 3600
                                }
                            ],
                            "name": "byteterrace.net"
                        },
                        {
                            "name": "byteterrace.org"
                        },
                        {
                            "name": "byteterrace.us"
                        },
                        {
                            "name": "byteterrace.xyz"
                        },
                        {
                            "name": "bytrc.com"
                        }
                    ]
                },
                "keyVaults": [
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "isAllowTrustedMicrosoftServicesEnabled": true,
                        "name": "byteterrace",
                        "secrets": {
                            "array": [
                                {
                                    "name": "Namecheap-ApiKey",
                                    "value": null
                                }
                            ]
                        },
                        "virtualNetworkRules": [
                            {
                                "subnetName": "byteterrace",
                                "virtualNetworkName": "byteterrace.net"
                            }
                        ]
                    }
                ],
                "loadBalancers": [
                    {
                        "backendAddressPools": [
                            {
                                "name": "default"
                            }
                        ],
                        "frontendIpConfigurations": [
                            {
                                "name": "default",
                                "privateIpAddress": {
                                    "allocationMethod": "Dynamic",
                                    "virtualNetwork": {
                                        "name": "byteterrace.net",
                                        "subnetName": "byteterrace"
                                    }
                                }
                            }
                        ],
                        "healthProbes": [
                            {
                                "name": "https",
                                "port": 443,
                                "protocol": "HTTPS",
                                "requestPath": "/healthcheck"
                            }
                        ],
                        "loadBalancingRules": [
                            {
                                "backendAddressPoolName": "default",
                                "frontendIpConfigurationName": "default",
                                "healthProbeName": "HTTPS",
                                "name": "https",
                                "port": 443,
                                "protocol": "TCP"
                            }
                        ],
                        "name": "byteterrace"
                    }
                ],
                "monitor": {
                    "applicationInsightsComponents": [
                        {
                            "logAnalyticsWorkspaceName": "byteterrace",
                            "name": "byteterrace"
                        }
                    ],
                    "logAnalyticsWorkspaces": [
                        {
                            "linkedStorageAccountName": "byteterrace",
                            "name": "byteterrace"
                        }
                    ],
                    "privateLinkScopes": [
                        {
                            "name": "byteterrace",
                            "scopedResources": [
                                {
                                    "path": "components/byteterrace",
                                    "providerName": "Microsoft.Insights"
                                },
                                {
                                    "path": "workspaces/byteterrace",
                                    "providerName": "Microsoft.OperationalInsights"
                                }
                            ]
                        }
                    ]
                },
                "natGateways": [
                    {
                        "name": "AzureContainerGroupsNatGateway",
                        "publicIpAddresses": [
                            {
                                "name": "AzureContainerGroupsPublicIpAddress"
                            }
                        ]
                    }
                ],
                "networkSecurityGroups": [
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "name": "AzureBastionNetworkSecurityGroup",
                        "securityRules": [
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "*" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Inbound",
                                "name": "Allow-AzureLoadBalancer-Inbound",
                                "priority": 4093,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "AzureLoadBalancer" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "VirtualNetwork" ],
                                "destinationPortRanges": [
                                    "5071",
                                    "8080"
                                ],
                                "direction": "Inbound",
                                "name": "Allow-BastionHostCommunication-Inbound",
                                "priority": 4094,
                                "protocol": "*",
                                "sourceAddressPrefixes": [ "VirtualNetwork" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "*" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Inbound",
                                "name": "Allow-Https-Inbound",
                                "priority": 4095,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "Internet" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "*" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Inbound",
                                "name": "Allow-GatewayManager-Inbound",
                                "priority": 4096,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "GatewayManager" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "AzureCloud" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Outbound",
                                "name": "Allow-AzureCloud-Outbound",
                                "priority": 4093,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "*" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "VirtualNetwork" ],
                                "destinationPortRanges": [
                                    "5071",
                                    "8080"
                                ],
                                "direction": "Outbound",
                                "name": "Allow-BastionHostCommunication-Outbound",
                                "priority": 4094,
                                "protocol": "*",
                                "sourceAddressPrefixes": [ "VirtualNetwork" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "Internet" ],
                                "destinationPortRanges": [ "80" ],
                                "direction": "Outbound",
                                "name": "Allow-GetSessionInformation-Outbound",
                                "priority": 4095,
                                "protocol": "*",
                                "sourceAddressPrefixes": [ "*" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "VirtualNetwork" ],
                                "destinationPortRanges": [
                                    "22",
                                    "3389"
                                ],
                                "direction": "Outbound",
                                "name": "Allow-SshRdp-Outbound",
                                "priority": 4096,
                                "protocol": "*",
                                "sourceAddressPrefixes": [ "*" ]
                            }
                        ]
                    },
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "name": "AzureContainerGroupsNetworkSecurityGroup",
                        "securityRules": []
                    },
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "name": "byteterrace.net",
                        "securityRules": [
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "VirtualNetwork" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Inbound",
                                "name": "Allow-AzureFrontDoor.FirstParty-Inbound",
                                "priority": 4092,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "AzureFrontDoor.FirstParty" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "VirtualNetwork" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Inbound",
                                "name": "Allow-AzureFrontDoor.Frontend-Inbound",
                                "priority": 4093,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "AzureFrontDoor.Frontend" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "VirtualNetwork" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Inbound",
                                "name": "Allow-HdInsight.EastUs-Inbound",
                                "priority": 4094,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "HDInsight.EastUS" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "VirtualNetwork" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Inbound",
                                "name": "Allow-HdInsight.SouthCentralUs-Inbound",
                                "priority": 4095,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "HDInsight.SouthCentralUS" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "VirtualNetwork" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Inbound",
                                "name": "Allow-HdInsight.WestUs-Inbound",
                                "priority": 4096,
                                "protocol": "TCP",
                                "sourceAddressPrefixes": [ "HDInsight.WestUS" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "AzureFrontDoor.FirstParty" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Outbound",
                                "name": "Allow-AzureFrontDoor.FirstParty-Outbound",
                                "priority": 4093,
                                "protocol": "*",
                                "sourceAddressPrefixes": [ "VirtualNetwork" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "AzureFrontDoor.Frontend" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Outbound",
                                "name": "Allow-AzureFrontDoor.Frontend-Outbound",
                                "priority": 4094,
                                "protocol": "*",
                                "sourceAddressPrefixes": [ "VirtualNetwork" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "AzureResourceManager" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Outbound",
                                "name": "Allow-AzureActiveDirectory-Outbound",
                                "priority": 4095,
                                "protocol": "*",
                                "sourceAddressPrefixes": [ "VirtualNetwork" ]
                            },
                            {
                                "access": "Allow",
                                "destinationAddressPrefixes": [ "AzureResourceManager" ],
                                "destinationPortRanges": [ "443" ],
                                "direction": "Outbound",
                                "name": "Allow-AzureResourceManager-Outbound",
                                "priority": 4096,
                                "protocol": "*",
                                "sourceAddressPrefixes": [ "VirtualNetwork" ]
                            }
                        ]
                    }
                ],
                "privateEndpoints": [
                    {
                        "dnsZones": [
                            {
                                "name": "privatelink.azconfig.io"
                            }
                        ],
                        "groupIds": [
                            "configurationStores"
                        ],
                        "linkedResourcePath": "configurationStores/byteterrace",
                        "linkedResourceProviderName": "Microsoft.AppConfiguration",
                        "name": "byteterrace-appconfig-privateendpoint",
                        "subnetName": "byteterrace",
                        "virtualNetworkName": "byteterrace.net"
                    },
                    {
                        "dnsZones": [
                            {
                                "name": "privatelink.agentsvc.azure-automation.net"
                            },
                            {
                                "name": "privatelink.blob.core.windows.net"
                            },
                            {
                                "name": "privatelink.monitor.azure.com"
                            },
                            {
                                "name": "privatelink.ods.opinsights.azure.com"
                            },
                            {
                                "name": "privatelink.oms.opinsights.azure.com"
                            }
                        ],
                        "groupIds": [
                            "azuremonitor"
                        ],
                        "linkedResourcePath": "privateLinkScopes/byteterrace",
                        "linkedResourceProviderName": "Microsoft.Insights",
                        "name": "byteterrace-monitor-privateendpoint",
                        "subnetName": "byteterrace",
                        "virtualNetworkName": "byteterrace.net"
                    }
                ],
                "proximityPlacementGroups": [
                    {
                        "name": "byteterrace"
                    }
                ],
                "publicIpAddresses": [
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "availabilityZones": [
                            "1",
                            "2",
                            "3"
                        ],
                        "name": "AzureBastionPublicIpAddress",
                        "skuName": "Standard",
                        "skuTier": "Regional",
                        "version": "IPv4"
                    },
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "availabilityZones": [
                            "1",
                            "2",
                            "3"
                        ],
                        "name": "AzureContainerGroupsPublicIpAddress",
                        "skuName": "Standard",
                        "skuTier": "Regional",
                        "version": "IPv4"
                    }
                ],
                "_sqlServers": [
                    {
                        "auditLogAnalyticsWorkspaceName": "byteterrace",
                        "databases": [
                            {
                                "name": "byteterrace"
                            }
                        ],
                        "name": "byteterrace"
                    }
                ],
                "storageAccounts": [
                    {
                        "isAllowTrustedMicrosoftServicesEnabled": true,
                        "name": "byteterrace",
                        "queueNames": [
                            "default"
                        ],
                        "virtualNetworkRules": [
                            {
                                "subnetName": "byteterrace",
                                "virtualNetworkName": "byteterrace.net"
                            }
                        ]
                    }
                ],
                "virtualMachines": [
                    {
                        "availabilitySetName": "byteterrace",
                        "diskEncryptionSetName": "byteterrace",
                        "imageReference": {
                            "offer": "Windows-10",
                            "publisher": "MicrosoftWindowsDesktop",
                            "sku": "20h2-pro-g2",
                            "version": "latest"
                        },
                        "licenseType": "Windows_Client",
                        "name": "byteterrace",
                        "networkInterfaceCards": [
                            {
                                "ipConfigurations": [
                                    {
                                        "addressVersion": "IPv4",
                                        "allocationMethod": "Dynamic",
                                        "applicationSecurityGroup": {
                                            "name": "byteterrace"
                                        },
                                        "loadBalancer": {
                                            "backendAddressPoolName": "default",
                                            "name": "byteterrace"
                                        },
                                        "name": "default",
                                        "subnet": {
                                            "name": "byteterrace",
                                            "virtualNetworkName": "byteterrace.net"
                                        }
                                    }
                                ]
                            }
                        ],
                        "priority": "Regular",
                        "size": "Standard_D4s_v4"
                    }
                ],
                "virtualNetworks": [
                    {
                        "addressPrefixes": [
                            "10.0.0.0/8"
                        ],
                        "name": "byteterrace.net",
                        "subnets": [
                            {
                                "addressPrefix": "10.255.255.128/26",
                                "name": "AzureBastionSubnet",
                                "networkSecurityGroup": {
                                    "name": "AzureBastionNetworkSecurityGroup"
                                }
                            },
                            {
                                "addressPrefix": "10.255.255.0/25",
                                "delegations": [
                                    {
                                        "name": "ACIDelegationService",
                                        "properties": {
                                            "serviceName": "Microsoft.ContainerInstance/containerGroups",
                                            "actions": [
                                                "Microsoft.Network/virtualNetworks/subnets/action"
                                            ]
                                        }
                                    }
                                ],
                                "name": "AzureContainerGroupsSubnet",
                                "natGateway": {
                                    "name": "AzureContainerGroupsNatGateway"
                                },
                                "networkSecurityGroup": {
                                    "name": "AzureContainerGroupsNetworkSecurityGroup"
                                }
                            },
                            {
                                "addressPrefix": "10.255.254.128/26",
                                "name": "AzureFirewallManagementSubnet"
                            },
                            {
                                "addressPrefix": "10.255.254.192/26",
                                "name": "AzureFirewallSubnet"
                            },
                            {
                                "addressPrefix": "10.255.255.192/26",
                                "isPrivateEndpointSupportEnabled": true,
                                "name": "byteterrace",
                                "networkSecurityGroup": {
                                    "name": "byteterrace.net"
                                },
                                "serviceEndpoints": [
                                    {
                                        "locations": [
                                            "*"
                                        ],
                                        "service": "Microsoft.AzureCosmosDB"
                                    },
                                    {
                                        "locations": [
                                            "*"
                                        ],
                                        "service": "Microsoft.KeyVault"
                                    },
                                    {
                                        "locations": [
                                            "southcentralus"
                                        ],
                                        "service": "Microsoft.Sql"
                                    },
                                    {
                                        "locations": [
                                            "brazilsouth",
                                            "northcentralus",
                                            "southcentralus"
                                        ],
                                        "service": "Microsoft.Storage"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        },
        "tags": {
            "value": {}
        }
    }
}
